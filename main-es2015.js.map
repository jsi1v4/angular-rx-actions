{"version":3,"sources":["./src/app/app.service.ts","./src/app/app.component.ts","./src/app/app.module.ts","./src/tools/state.ts","./src/tools/action.ts","./src/main.ts","./$_lazy_route_resource lazy namespace object"],"names":[],"mappings":"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","file":"main-es2015.js","sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { of, throwError } from 'rxjs';\r\nimport { delay, switchMap } from 'rxjs/operators';\r\n\r\nexport interface Hero {\r\n  name: string;\r\n  level: number;\r\n}\r\n\r\nconst heroes: Hero[] = [\r\n  { name: 'Peter', level: 25 },\r\n  { name: 'Tony', level: 50 },\r\n  { name: 'Stephen', level: 99 }\r\n];\r\n\r\n@Injectable()\r\nexport class AppService {\r\n\r\n  constructor() { }\r\n\r\n  getHeroes() {\r\n    return of(heroes.slice(0, Math.floor(Math.random() * heroes.length)))\r\n      .pipe(\r\n        delay(3000)\r\n      );\r\n  }\r\n\r\n  getVillains() {\r\n    return of([])\r\n      .pipe(\r\n        delay(3000),\r\n        switchMap(() => throwError({ message: 'You shall not pass...' }))\r\n      );\r\n  }\r\n}\r\n","import { ChangeDetectionStrategy, Component } from '@angular/core';\n\nimport { Action } from 'src/tools/action';\nimport { State } from 'src/tools/state';\nimport { AppService, Hero } from './app.service';\n\n@Component({\n  selector: 'app-root',\n  template: `\n    <h1>Angular Reactive Actions</h1>\n    <div class=\"container\">\n      <ng-container *ngIf=\"request.$ | async as data\">\n        <p class=\"gap\">\n          <button (click)=\"getHeroes()\">Heroes</button>\n          <button (click)=\"getVillains()\">Villains</button>\n        </p>\n        <span *ngIf=\"data.loading\">Loading...</span>\n        <span *ngIf=\"data.error\">Error! {{ data.error }}</span>\n        <h4 *ngIf=\"data.pristine\">Click to show table of heroes.</h4>\n        <ng-container *ngIf=\"data.payload\">\n          <table>\n            <thead>\n              <tr>\n                <th>Name</th>\n                <th>Level</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr *ngFor=\"let row of data.payload\">\n                <td>{{ row.name }}</td>\n                <td>{{ row.level }}</td>\n              </tr>\n            </tbody>\n          </table>\n        </ng-container>\n      </ng-container>\n      <ng-container *ngIf=\"copy.$ | async as data\">\n        <h4 *ngIf=\"!!data.length\">\n          This is a copy of heroes [length = {{ data.length }}], but it can be used to store some state of application.\n        </h4>\n      </ng-container>\n    </div>\n  `,\n  styles: [\n    `\n      .container {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        padding: 1rem;\n      }\n\n      .gap > * {\n        margin: 0 .5rem .5rem;\n      }\n\n      h1, th, td {\n        text-align: center;\n      }\n\n      th, td {\n        padding: .5rem;\n      }\n\n      th {\n        font-weight: bold;\n      }\n    `\n  ],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class AppComponent {\n  readonly request = new Action<Hero[]>();\n  readonly copy = new State<Hero[]>([]);\n\n  constructor(private appService: AppService) { }\n\n  getHeroes() {\n    this.request.exec(\n      this.appService.getHeroes(),\n      (response) => {\n        console.log('success', response);\n        this.copy.setValue(response.slice());\n      },\n      (error) => console.log('error', error)\n    );\n  }\n\n  getVillains() {\n    this.request.exec(\n      this.appService.getVillains(),\n      (response) => console.log('success', response),\n      (error) => console.log('error', error)\n    );\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { BrowserModule } from '@angular/platform-browser';\n\nimport { AppService } from './app.service';\nimport { AppComponent } from './app.component';\n\n@NgModule({\n  declarations: [AppComponent],\n  imports: [BrowserModule],\n  providers: [AppService],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n","import { BehaviorSubject } from 'rxjs';\r\n\r\nexport class State<T> {\r\n  private source: BehaviorSubject<T>;\r\n\r\n  get value() {\r\n    return this.source.value;\r\n  }\r\n  get $() {\r\n    return this.source.asObservable();\r\n  }\r\n\r\n  constructor(initialValue: T) {\r\n    this.source = new BehaviorSubject(initialValue);\r\n  }\r\n\r\n  setValue(value: T) {\r\n    this.source.next(value);\r\n  }\r\n}\r\n","import { BehaviorSubject, Observable, of } from 'rxjs';\r\nimport { first, concatMap, catchError, shareReplay } from 'rxjs/operators';\r\n\r\nexport interface Wrapper<T> {\r\n  payload: T | undefined;\r\n  loading: boolean;\r\n  error: string;\r\n  pristine: boolean;\r\n  valid: boolean;\r\n}\r\n\r\nexport interface Error {\r\n  status: number;\r\n  message: string;\r\n}\r\n\r\nconst wrapper = (\r\n  payload, loading = false, error = '', pristine = true, valid = false\r\n) => ({\r\n  payload, loading, error, pristine, valid\r\n});\r\n\r\nexport class Action<T> {\r\n  private source: BehaviorSubject<Wrapper<T>>;\r\n\r\n  constructor(initialValue?: T) {\r\n    this.source = new BehaviorSubject(wrapper(initialValue));\r\n  }\r\n\r\n  get value() {\r\n    return this.source.value;\r\n  }\r\n  get $() {\r\n    return this.source.asObservable();\r\n  }\r\n\r\n  public exec(\r\n    request: Observable<T | undefined>,\r\n    onSuccess = (res: T) => { },\r\n    onError = (err: Error) => { },\r\n    mutation = (res: T) => {\r\n      return res;\r\n    }\r\n  ) {\r\n    this.source.next(wrapper(undefined, true, '', false));\r\n    request\r\n      .pipe(\r\n        first(),\r\n        concatMap((res: T) => {\r\n          onSuccess(res);\r\n          const result = mutation(res);\r\n          return of(wrapper(result, false, '', false, true));\r\n        }),\r\n        catchError((err: Error) => {\r\n          onError(err);\r\n          return of(wrapper(undefined, false, err.message, false));\r\n        }),\r\n        shareReplay(1)\r\n      )\r\n      .subscribe((result) => this.source.next(result));\r\n  }\r\n\r\n  public reset() {\r\n    this.source.next(wrapper(undefined));\r\n  }\r\n}\r\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\n\nenableProdMode();\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"zn8P\";"],"sourceRoot":"webpack:///"}